<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.huang.dao.CourseMapper">


    <!--增-->
    <insert id="addCourse" parameterType="Course">
        insert into course(course_name, user_code)
        VALUES (#{courseName},#{userCode})
    </insert>
    <!--删-->
    <delete id="deleteCourse" parameterType="int">
        delete from course where cid=#{cid}
    </delete>

    <!--改-->
    <update id="updateCourse" parameterType="Course">
        update course set course_name=#{courseName},user_code=#{userCode}
        where cid=#{cid}
    </update>

    <!--查-->
    <select id="queryCourseById" resultMap="courseMap">
        select *  from course where cid=#{cid}
    </select>


    <select id="queryAllCourse" resultMap="courseMap">
        select c.*,u.userName from user u , course c where c.user_code = u.userCode
        <if test="userName">
            and u.userName like concat('%',#{userName},'%')
        </if>
        <if test="course_name!=null">
            and c.course_name like concat('%',#{course_name},'%')
        </if>
        limit #{from},#{pageSize}
    </select>

    <!--Courseap值对应-->
    <resultMap id="courseMap" type="course">
        <id property="cid" column="cid"></id>
        <id property="courseName" column="course_name"></id>
        <id property="userCode" column="user_code"></id>
        <id property="userName" column="userName"></id>

    </resultMap>


    <!--&lt;!&ndash;验证账号实现&ndash;&gt;-->
    <!--<select id="userCode" parameterType="int">-->
        <!--select * from user where userCode=#{userCode}-->
    <!--</select>-->

    <!--查询总人数-->
    <select id="getCourseCount" resultType="_int">
        select count(cid) from course,user where user.userCode=course.user_code
            <if test="userName!=null">
                and userName like concat('%',#{userName},'%')
            </if>
            <if test="course_name!=null">
                and course_name like concat('%',#{course_name},'%')
            </if>
    </select>

    <select id="selectAllCourse" resultMap="courseMap">
        select * from course
    </select>


</mapper>